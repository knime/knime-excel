<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>POIFS Use Cases</title>
<link type="text/css" href="../skin/page.css" rel="stylesheet">
</head>
<body text="#000000" bgcolor="#FFFFFF">
<!--================= start Navigation Path ==================-->
<table summary="navigation path" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td nowrap="nowrap" valign="middle" bgcolor="#CFDCED" height="20"><img height="1" width="5" alt="" src="../skin/images/spacer.gif" class="spacer"><!--===== breadcrumb trail (javascript-generated) ====--><font size="2" face="Arial, Helvetica, Sans-serif"><script src="../skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script></font></td>
</tr>
<tr>
<td bgcolor="#4C6C8F" height="2"><img height="2" width="2" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
<!--================= end Navigation Path ==================-->
<!--================= start Banner ==================-->
<table summary="header with logos" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<!--================= start Group Logo ==================-->
<td bgcolor="#294563"><a href="http://jakarta.apache.org"><img border="0" class="logoImage" alt="Jakarta" src="../resources/images/group-logo.gif"></a></td>
<!--================= end Group Logo ==================-->
<!--================= start Project Logo ==================--><td width="100%" align="center" bgcolor="#294563"><a href="http://jakarta.apache.org/poi/"><img border="0" class="logoImage" alt="POI" src="../resources/images/project-logo.gif"></a></td>
<!--================= end Project Logo ==================-->
<!--================= start Search ==================--><td valign="top" rowspan="2" bgcolor="#294563">
<form target="_blank" action="http://www.google.com/search" method="get">
<table summary="search" border="0" cellspacing="0" cellpadding="0" bgcolor="#4C6C8F">
<tr>
<td colspan="3"><img height="10" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap"><input value="jakarta.apache.org" name="sitesearch" type="hidden"><input size="15" name="q" id="query" type="text"><img height="1" width="5" alt="" src="../skin/images/spacer.gif" class="spacer"><input name="Search" value="Search" type="submit">
<br>
<font face="Arial, Helvetica, Sans-serif" size="2" color="white">
                      the jakarta site
                      
                      
                    </font></td><td><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td><img alt="" border="0" height="10" width="9" src="../skin/images/search-left.gif"></td><td><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td><img alt="" border="0" height="10" width="9" src="../skin/images/search-right.gif"></td>
</tr>
</table>
</form>
</td>
<!--================= start Search ==================--><td bgcolor="#294563"><img height="10" width="10" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td valign="bottom" bgcolor="#294563" colspan="2">
<!--================= start Tabs ==================-->
<div class="tab">
<table summary="tab bar" border="0" cellpadding="0" cellspacing="0">
<tr>
<td width="6"><img alt="" height="8" width="6" src="../skin/images/spacer.gif"></td><td valign="bottom">
<table summary="selected tab" style="height: 1.8em" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="../skin/images/tabSel-left.gif"></td><td valign="middle" bgcolor="#4C6C8F"><font color="#ffffff" size="2" face="Arial, Helvetica, Sans-serif"><b><a class="base-selected" href="../index.html">Home</a></b></font></td><td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="../skin/images/tabSel-right.gif"></td>
</tr>
</table>
</td>
</tr>
</table>
</div>
<!--================= end Tabs ==================-->
</td><td bgcolor="#294563"><img alt="" width="1" height="1" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td bgcolor="#4C6C8F" colspan="4"><img width="1" height="10" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
<!--================= end Banner ==================-->
<!--================= start Menu, NavBar, Content ==================-->
<table summary="page content" bgcolor="#ffffff" width="100%" border="0" cellpadding="0" cellspacing="0">
<tr>
<td valign="top">
<table summary="menu" border="0" cellspacing="0" cellpadding="0">
<tr>
<!--================= start left top NavBar ==================-->
<td rowspan="3" valign="top">
<table summary="blue line" border="0" cellpadding="0" cellspacing="0">
<tr>
<td bgcolor="#294563"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td bgcolor="#CFDCED"><font color="#4C6C8F" size="4" face="Arial, Helvetica, Sans-serif">&nbsp;</font></td>
</tr>
<tr>
<td bgcolor="#294563"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
</td>
<!--================= end left top NavBar ==================--><td bgcolor="#294563"><img width="1" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td valign="bottom" bgcolor="#4C6C8F"><img width="10" height="10" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td nowrap="nowrap" valign="top" bgcolor="#4C6C8F">
<!--================= start Menu items ==================-->
<div class="menu">
<ul>
<li>
<font color="#CFDCED">Navigation</font>
<ul>
<li>
<a href="../index.html">Main</a>
</li>
<li>
<a href="how-to.html">How To</a>
</li>
<li>
<a href="fileformat.html">File System Documentation</a>
</li>
<li>
<span class="sel"><font color="#ffcc00">Use Cases</font></span>
</li>
</ul>
</li>
</ul>
</div>
<!--================= end Menu items ==================-->
</td><td valign="bottom" bgcolor="#4C6C8F"><img width="10" height="10" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td bgcolor="#294563"><img width="1" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td valign="bottom" align="left" colspan="2" rowspan="2" bgcolor="#4C6C8F"><img height="10" width="10" border="0" alt="" src="../skin/images/menu-left.gif"></td><td bgcolor="#4C6C8F"><img height="10" width="10" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td valign="bottom" align="right" colspan="2" rowspan="2" bgcolor="#4C6C8F"><img height="10" width="10" border="0" alt="" src="../skin/images/menu-right.gif"></td>
</tr>
<tr>
<td height="1" bgcolor="#294563"><img width="1" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
</table>
</td><td valign="top" width="100%">
<table summary="content" width="100%" border="0" cellpadding="0" cellspacing="0">
<!--================= start middle NavBar ==================-->
<tr>
<td colspan="4" bgcolor="#294563"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td align="left" width="10" bgcolor="#CFDCED"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td align="left" width="50%" bgcolor="#CFDCED"><font color="#4C6C8F" size="3" face="Arial, Helvetica, Sans-serif">
                &nbsp;
                
                </font><img width="10" height="8" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td align="right" width="50%" bgcolor="#CFDCED"><font color="#4C6C8F" size="3" face="Arial, Helvetica, Sans-serif">
                &nbsp;
                
                </font><img width="10" height="8" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td width="10" bgcolor="#CFDCED"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<tr>
<td colspan="4" bgcolor="#294563"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<!--================= end middle NavBar ==================-->
<!--================= start Content==================-->
<tr>
<td align="left" width="10"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td><td colspan="2" align="left" width="100%">
<div class="content">
<table class="title" summary="">
<tr>
<td valign="middle">
<h1>POIFS Use Cases</h1>
</td><td nowrap="nowrap" width="40" align="center"><a class="dida" href="usecases.pdf"><img alt="PDF" src="../skin/images/pdfdoc.gif" class="skin"><br>
          PDF</a></td>
</tr>
</table>
<ul class="minitoc">
<li>
<a href="#POIFS+Use+Cases">POIFS Use Cases</a>
<ul class="minitoc">
<li>
<a href="#Use+Case+1%3A+Read+existing+file+system">Use Case 1: Read existing file system</a>
</li>
<li>
<a href="#Use+Case+2%3A+Write+file+system">Use Case 2: Write file system</a>
</li>
<li>
<a href="#Use+Case+3%3A+Create+new+file+system">Use Case 3: Create new file system</a>
</li>
<li>
<a href="#Use+Case+4%3A+Replace+file+in+file+system">Use Case 4: Replace file in file system</a>
</li>
<li>
<a href="#Use+Case+5%3A+Delete+file+from+file+system">Use Case 5: Delete file from file system</a>
</li>
<li>
<a href="#Use+Case+6%3A+Write+new+file+to+file+system">Use Case 6: Write new file to file system</a>
</li>
<li>
<a href="#Use+Case+7%3A+Read+existing+file+from+file+system">Use Case 7: Read existing file from file system</a>
</li>
<li>
<a href="#Use+Case+8%3A+Read+file+system+directory">Use Case 8: Read file system directory</a>
</li>
<li>
<a href="#Use+Case+9%3A+Read+file">Use Case 9: Read file</a>
</li>
<li>
<a href="#Use+Case+10%3A+Rename+existing+file+in+the+file+system">Use Case 10: Rename existing file in the file system</a>
</li>
</ul>
</li>
</ul>
    
<a name="N10015"></a><a name="POIFS+Use+Cases"></a>
<h3>POIFS Use Cases</h3>
<div style="margin-left: 0 ; border: 2px">
<a name="N1001A"></a><a name="Use+Case+1%3A+Read+existing+file+system"></a>
<h4>Use Case 1: Read existing file system</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Primary Actor:</em></td>
	    <td colspan="1" rowspan="1">POIFS client</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Scope:</em></td>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Level:</em></td>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Stakeholders and Interests:</em></td>
	    <td colspan="1" rowspan="1">
              POIFS client- wants to read content of file
                  system<br>
              POIFS - understands POIFS file system
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Precondition:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Minimal Guarantee:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Main Success Guarantee:</em></td>
	    <td colspan="1" rowspan="1">
            1. POIFS client requests POIFS to read a POIFS file
                system, providing an
                <span class="codefrag">InputStream</span>
                containing POIFS file system in question.<br>
            2. POIFS reads from the
                <span class="codefrag">InputStream</span> in
                512 byte blocks.<br>
            3. POIFS verifies that the first block begins with
                the well known signature
                (
                <span class="codefrag">0xE11AB1A1E011CFD0</span>)<br>
            4. POIFS reads the Block Allocation Table from the
                first block and, if necessary, from the XBAT
                blocks.<br>
            5. POIFS obtains the start block of the Property
                Table and reads the Property Table (use case 9,
                read file)<br>
            6. POIFS reads the individual entries in the Property
                Table<br>
            7. POIFS obtains the start block of the Small Block
                Allocation Table and reads the Small Block
                Allocation Table (use case 9, read file)<br>
            8. POIFS obtains the start block of the Small Block
                store from the first entry in the Property Table
                and reads the Small Block Array (use case 9, read
                file)<br>
        
</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Extensions:</em></td>
	    <td colspan="1" rowspan="1">
	        2a. If the last block read is not a 512 byte
                block, the
                <span class="codefrag">InputStream</span> is not that of
                a POIFS file system, and POIFS throws an
                appropriate exception.
            <br>
		    3a. If the signature is incorrect, the
            <span class="codefrag">InputStream</span> is not that of a POIFS
            file system, and POIFS throws an appropriate
		    exception.<br>
	    
</td>
	  
</tr>
	
</table>
</div>
<a name="N100B8"></a><a name="Use+Case+2%3A+Write+file+system"></a>
<h4>Use Case 2: Write file system</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<th colspan="1" rowspan="1">Primary Actor:</th>
	    <th colspan="1" rowspan="1">POIFS client</th>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Scope:</th>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Level:</th>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Stakeholders and Interests:</th>
	    <td colspan="1" rowspan="1">
            POIFS client- wants to write file system out.<br>
            POIFS - knows how to write file system out.
	    </td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Precondition:</th>
	    <td colspan="1" rowspan="1">
	        File system has been read (use case 1, read
	            existing file system) and subsequently modified
	            (use case 4, replace file in file system; use case
	            5, delete file from file system; or use case 6,
	            write new file to file system; in any
	            combination)
	      <br>or<br>
	        File system has been created (use case 3, create
	            new file system)
	    </td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Minimal Guarantee:</th>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Main Success Guarantee:</th>
	    <td colspan="1" rowspan="1">
                1. POIFS client provides an
                    <span class="codefrag">OutputStream</span>
                    to write the file system to.
                <br>
                2. POIFS gets the sizes of the Property Table and
                    each file in the file system.<br>
                3. If any files in the file system requires storage
                    in a Small Block Array, POIFS creates a Small
                    Block Array of sufficient size to hold all of the
                    small files.<br>
                4. POIFS calculates the number of big blocks needed
                    to hold all of the large files, the Property
                    Table, and, if necessary, the Small Block Array
                    and the Small Block Allocation Table.<br>
                5. POIFS creates a set of big blocks sufficient to
                    store the Block Allocation Table<br>
                6. POIFS creates and writes the header block<br>
                7. POIFS writes out the XBAT blocks, if needed.<br>
                8. POIFS writes out the Small Block Array, if
                    needed<br>
                9. POIFS writes out the Small Block Allocation Table,
                    if needed<br>
                10. POIFS writes out the Property Table<br>
                11. POIFS writes out the large files, if needed<br>
                12. POIFS closes the <span class="codefrag">OutputStream</span>.
	    </td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Extensions:</th>
	    <td colspan="1" rowspan="1">
              6a. Exceptions writing to the
                  <span class="codefrag">OutputStream</span> will be propagated back
                  to the POIFS client.
              <br>
              7a. Exceptions writing to the
                  <span class="codefrag">OutputStream</span> will be propagated back
                  to the POIFS client.
              <br>
              8a. Exceptions writing to the
                  <span class="codefrag">OutputStream</span> will be propagated back
                  to the POIFS client.
              <br>
              9a. Exceptions writing to the
                  <span class="codefrag">OutputStream</span> will be propagated back
                  to the POIFS client.
              <br>
              10a. Exceptions writing to the
                  <span class="codefrag">OutputStream</span> will be propagated back
                  to the POIFS client.
              <br>
              11a. Exceptions writing to the
                  <span class="codefrag">OutputStream</span> will be propagated back
                  to the POIFS client.
              <br>
              12a. Exceptions closing the
                  <span class="codefrag">OutputStream</span> will be propagated back
                  to the POIFS client.
              <br>
	    
</td>
	  
</tr>
	
</table>
</div>
<a name="N1016E"></a><a name="Use+Case+3%3A+Create+new+file+system"></a>
<h4>Use Case 3: Create new file system</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<th colspan="1" rowspan="1">Primary Actor:</th>
	    <td colspan="1" rowspan="1">POIFS client</td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Scope:</th>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Level:</th>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Stakeholders and Interests:</th>
	    <td colspan="1" rowspan="1">
	        POIFS client- wants to create a new file
	            system<br>
    		POIFS - knows how to create a new file system
	    </td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Precondition:</th>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Minimal Guarantee:</th>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Main Success Guarantee:</th>
	    <td colspan="1" rowspan="1">
	      	POIFS creates an empty Property Table.
	    </td>
	  
</tr>
	  
<tr>
	    
<th colspan="1" rowspan="1">Extensions:</th>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	
</table>
</div>
<a name="N101E1"></a><a name="Use+Case+4%3A+Replace+file+in+file+system"></a>
<h4>Use Case 4: Replace file in file system</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Primary Actor:</em></td>
	    <td colspan="1" rowspan="1">POIFS client</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Scope:</em></td>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Level:</em></td>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Stakeholders and Interests:</em></td>
	    <td colspan="1" rowspan="1">
	        1. POIFS client- wants to replace an existing file in
	            the file system<br>
		    2. POIFS - knows how to manage the file system
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Precondition:</em></td>
	    <td colspan="1" rowspan="1">
	      Either
	      <br>
<br>
	        The file system has been read (use case 1, read
	            existing file system) and a file has been
	            extracted from the file system (use case 7, read
	            existing file from file system)
	      <br>
<br>or<br>
<br>
	        The file system has been created (use case 3,
	            create new file system) and a file has been
	            written to the file system (use case 6, write new
	            file to file system)
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Minimal Guarantee:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Main Success Guarantee:</em></td>
	    <td colspan="1" rowspan="1">
	        1. POIFS discards storage of the existing file.<br>
  	        2. POIFS updates the existing file's entry in the
	            Property Table<br>
	        3. POIFS stores the new file's data
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Extensions:</em></td>
	    <td colspan="1" rowspan="1">
	        1a. POIFS throws an exception if the file does not
	            exist.
	    </td>
	  
</tr>
	
</table>
</div>
<a name="N10269"></a><a name="Use+Case+5%3A+Delete+file+from+file+system"></a>
<h4>Use Case 5: Delete file from file system</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Primary Actor:</em></td>
	    <td colspan="1" rowspan="1">POIFS client</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Scope:</em></td>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Level:</em></td>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Stakeholders and Interests:</em></td>
	    <td colspan="1" rowspan="1">
	        * POIFS client- wants to remove a file from a file
	            system<br>
		    * POIFS - knows how to manage the file system
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Precondition:</em></td>
	    <td colspan="1" rowspan="1">
	      Either<br>
<br>
	        The file system has been read (use case 1, read
	            existing file system) and a file has been
	            extracted from the file system (use case 7, read
	            existing file from file system)<br>
	      
<br>
	      or<br>
	      
<br>
	        The file system has been created (use case 3,
	            create new file system) and a file has been
	            written to the file system (use case 6, write new
	            file to file system)
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Minimal Guarantee:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Main Success Guarantee:</em></td>
	    <td colspan="1" rowspan="1">
	      	1. POIFS discards the specified file's storage.<br>
	      	2. POIFS discards the file's Property Table
	      	    entry.
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Extensions:</em></td>
	    <td colspan="1" rowspan="1">
	        1a. POIFS throws an exception if the file does not
	            exist.
	    </td>
	  
</tr>
	
</table>
</div>
<a name="N102F1"></a><a name="Use+Case+6%3A+Write+new+file+to+file+system"></a>
<h4>Use Case 6: Write new file to file system</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Primary Actor:</em></td>
	    <td colspan="1" rowspan="1">POIFS client</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Scope:</em></td>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Level:</em></td>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Stakeholders and Interests:</em></td>
	    <td colspan="1" rowspan="1">
	        * POIFS client- wants to add a new file to the file
	            system<br>
		    * POIFS - knows how to manage the file system
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Precondition:</em></td>
	    <td colspan="1" rowspan="1">The specified file does not yet exist in the file
	        system</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Minimal Guarantee:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Main Success Guarantee:</em></td>
	    <td colspan="1" rowspan="1">
	        1. The POIFS client provides a file name<br>
	        2. POIFS creates a new Property Table entry for the
	            new file<br>
	        3. POIFS provides the POIFS client with an
	            <span class="codefrag">OutputStream</span> to write to.<br>
	        4. The POIFS client writes data to the provided
	            <span class="codefrag">OutputStream</span>.<br>
	        5. The POIFS client closes the provided
	            <span class="codefrag">OutputStream</span>
<br>
	        6. POIFS updates the Property Table entry with the
	            new file's size
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Extensions:</em></td>
	    <td colspan="1" rowspan="1">
	        1a. POIFS throws an exception if a file with the
	            specified name already exists in the file
	            system.<br>
            1b. POIFS throws an exception if the file name is
                too long. The limit on file name length is 31
                characters.
	    </td>
	  
</tr>
	
</table>
</div>
<a name="N10380"></a><a name="Use+Case+7%3A+Read+existing+file+from+file+system"></a>
<h4>Use Case 7: Read existing file from file system</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Primary Actor:</em></td>
	    <td colspan="1" rowspan="1">POIFS client</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Scope:</em></td>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Level:</em></td>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Stakeholders and Interests:</em></td>
	    <td colspan="1" rowspan="1">
	        * POIFS client- wants to read a file from the file
	            system<br>
		    * POIFS - knows how to manage the file system
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Precondition:</em></td>
	    <td colspan="1" rowspan="1">
	        * The file system has been read (use case 1, read
	            existing file system) or has been created and
	            written to (use case 3, create new file system;
	            use case 6, write new file to file system).<br>
            * The specified file exists in the file system.
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Minimal Guarantee:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Main Success Guarantee:</em></td>
	    <td colspan="1" rowspan="1">
	        * The POIFS client provides the name of a file to be read <br>
            * POIFS provides an <span class="codefrag">InputStream</span> to read from. <br>
            * The POIFS client reads from the <span class="codefrag">InputStream</span>.<br>
            * The POIFS client closes the <span class="codefrag">InputStream</span>.
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Extensions:</em></td>
	    <td colspan="1" rowspan="1">1a. POIFS throws an exception if no file with the
	        specified name exists.</td>
	  
</tr>
	
</table>
</div>
<a name="N1040C"></a><a name="Use+Case+8%3A+Read+file+system+directory"></a>
<h4>Use Case 8: Read file system directory</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Primary Actor:</em></td>
	    <td colspan="1" rowspan="1">POIFS client</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Scope:</em></td>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Level:</em></td>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Stakeholders and Interests:</em></td>
	    <td colspan="1" rowspan="1">
	        * POIFS client- wants to know what files exist in
	            the file system<br>
            * POIFS - knows how to manage the file system
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Precondition:</em></td>
	    <td colspan="1" rowspan="1">The file system has been read (use case 1, read
	        existing file system) or created (use case 3, create
	        new file system)</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Minimal Guarantee:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Main Success Guarantee:</em></td>
	    <td colspan="1" rowspan="1">
	        1. The POIFS client requests the file system
	            directory.
		    2. POIFS returns an <span class="codefrag">Iterator</span>. The
		    <span class="codefrag">Iterator</span> will not include the root
		    entry in the Property Table, and may be an
		    <span class="codefrag">Iterator</span> over an empty
		    <span class="codefrag">Collection</span>.
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Extensions:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	
</table>
</div>
<a name="N10493"></a><a name="Use+Case+9%3A+Read+file"></a>
<h4>Use Case 9: Read file</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Primary Actor:</em></td>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Scope:</em></td>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Level:</em></td>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Stakeholders and Interests:</em></td>
	    <td colspan="1" rowspan="1">
	            POIFS - POIFS needs to read a file, or something
	            resembling a file (i.e., the Property Table, the
	            Small Block Array, or the Small Block Allocation
	            Table)
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Precondition:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Minimal Guarantee:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Main Success Guarantee:</em></td>
	    <td colspan="1" rowspan="1">
	        1. POIFS begins with a start block, a file size, and
	            a flag indicating whether to use the Big Block
	            Allocation Table or the Small Block Allocation
	            Table<br>
            2. POIFS returns an <span class="codefrag">InputStream</span>.<br>
            3. Reads from the <span class="codefrag">InputStream</span> are
                performed by walking the specified Block
                Allocation Table and reading the blocks
                indicated.<br>
            4. POIFS closes the <span class="codefrag">InputStream</span> when
                finished reading the file, or its client wants to
                close the <span class="codefrag">InputStream</span>.
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Extensions:</em></td>
	    <td colspan="1" rowspan="1">3a. An exception will be thrown if the specified Block
	        Allocation Table is corrupt, as evidenced by an index
	        pointing to a non-existent block, or by a chain
	        extending past the known size of the file.</td>
	  
</tr>
	
</table>
</div>
<a name="N1051E"></a><a name="Use+Case+10%3A+Rename+existing+file+in+the+file+system"></a>
<h4>Use Case 10: Rename existing file in the file system</h4>
<div style="margin-left: 0 ; border: 2px">
<table class="ForrestTable" cellspacing="1" cellpadding="4">
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Primary Actor:</em></td>
	    <td colspan="1" rowspan="1">POIFS client</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Scope:</em></td>
	    <td colspan="1" rowspan="1">POIFS</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Level:</em></td>
	    <td colspan="1" rowspan="1">Summary</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Stakeholders and Interests:</em></td>
	    <td colspan="1" rowspan="1">
	        * POIFS client- wants to rename an existing file in
	            the file system.<br>
            * POIFS - knows how to manage the file system.
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Precondition:</em></td>
	    <td colspan="1" rowspan="1">
	        * The file system is has been read (use case 1, read
	            existing file system) or has been created and
	            written to (use case 3, create new file system;
	            use case 6, write new file to file system.<br>
            * The specified file exists in the file system.<br>
            * The new name for the file does not duplicate
                another file in the file system.
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Minimal Guarantee:</em></td>
	    <td colspan="1" rowspan="1">None</td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Main Success Guarantee:</em></td>
	    <td colspan="1" rowspan="1">
	        1. POIFS updates the Property Table entry for the
	            specified file with its new name.
	    </td>
	  
</tr>
	  
<tr>
	    
<td colspan="1" rowspan="1"><em>Extensions:</em></td>
	    <td colspan="1" rowspan="1">
	        * 1a. If the old file name is not in the file
	            system, POIFS throws an exception.<br>
            * 1b. If the new file name already exists in the
                file system, POIFS throws an exception.<br>
            * 1c. If the new file name is too long (the limit is
                31 characters), POIFS throws an exception.
	    </td>
	  
</tr>
	
</table>
</div>
</div>
  
<div class="attribution">by&nbsp;Marc Johnson</div>
</div>
</td><td width="10"><img width="10" height="1" alt="" src="../skin/images/spacer.gif" class="spacer"></td>
</tr>
<!--================= end Content==================-->
</table>
</td>
</tr>
</table>
<!--================= end Menu, NavBar, Content ==================-->
<!--================= start Footer ==================-->
<table summary="footer" cellspacing="0" cellpadding="0" width="100%" border="0">
<tr>
<td colspan="2" height="1" bgcolor="#4C6C8F"><img height="1" width="1" alt="" src="../skin/images/spacer.gif" class="spacer"><a href="../skin/images/label.gif"></a><a href="../skin/images/page.gif"></a><a href="../skin/images/chapter.gif"></a><a href="../skin/images/chapter_open.gif"></a><a href="../skin/images/current.gif"></a><a href="/favicon.ico"></a></td>
</tr>
<tr>
<td colspan="2" bgcolor="#CFDCED" class="copyright" align="center"><font size="2" face="Arial, Helvetica, Sans-Serif">Copyright &copy;
          2003&nbsp;The Apache Software Foundation. All rights reserved.<script type="text/javascript" language="JavaScript"><!--
              document.write(" - "+"Last Published: " + document.lastModified);
            //  --></script></font></td>
</tr>
<tr>
<td colspan="2" align="left" bgcolor="#CFDCED" class="logos"></td>
</tr>
</table>
<!--================= end Footer ==================-->
</body>
</html>
